#!/bin/sh

. `dirname "$0"`/functions
. detect-environment
. version

set -x

OUTDIR="$BASEDIR/output/${OS}-${OS_VERSION}-${ARCH}"
mkdir -p "$OUTDIR"

for dir in cfengine-community cfengine-nova; do
  if [ -d build/$dir ]; then
    case "$PACKAGING" in
      rpm)
        cp build/$dir/RPMS/*/*.rpm "$OUTDIR"
        ;;
      deb)
        cp build/$dir/*.deb "$OUTDIR"
        ;;
      msi)
        cp build/$dir/*.msi "$OUTDIR"
        ;;
      solaris)
        cp build/$dir/*.pkg "$OUTDIR"
        ;;
      *)
        echo "Unknown packaging system: $PACKAGING"
        exit 1;;
    esac
  fi
done

if [ -f build/core/tests/acceptance/summary.log ]; then
  cp build/core/tests/acceptance/*.log "$OUTDIR"
fi
